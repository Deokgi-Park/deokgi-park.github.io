---
title: "[ì˜¨í”„ë ˆë¯¸ìŠ¤ í™˜ê²½] ì¿ ë²„ë„¤í‹°ìŠ¤ ë° CI/CD êµ¬ì¶•ê¸°"
date: 2025-06-27
toc: true
toc_label: "ì¿ ë²„ë„¤í‹°ìŠ¤ êµ¬ì¶•"
toc_icon: "list-squares"
categories: intro
tags: [k8s, k3s, post]
auther_profile: true
---

## [ì˜¨í”„ë ˆë¯¸ìŠ¤ í™˜ê²½] ì¿ ë²„ë„¤í‹°ìŠ¤ ë° CI/CD êµ¬ì¶•ê¸°

### 01. ì»¨í…Œì´ë„ˆ ì—”ì§„ ì„¤ì¹˜

#### 1) ë„ì»¤ ì„¤ì¹˜

> ğŸ“ **ì„¤ëª…** : ì¿ ë²„ë„¤í‹°ìŠ¤ í™˜ê²½ì—ì„œ ì´ë¯¸ì§€ë¥¼ ê°€ì ¸ì˜¤ê±°ë‚˜ ê´€ë¦¬í•˜ê³  ì»¨í…Œì´ë„ˆ í™˜ê²½ì—ì„œ ì‹¤í–‰ì‹œí‚¤ê¸° ìœ„í•´ ì»¨í…Œì´ë„ˆ ì—”ì§„ì„ ì„¤ì¹˜í•´ì•¼í•œë‹¤.

> **â¡ï¸ ì»¨í…Œì´ë„ˆ ì—”ì§„/ëŸ°íƒ€ì„ ì¢…ë¥˜**
>
> **ë„ì»¤ ì—”ì§„ (Docker Engine):**
> ê°€ì¥ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” ì»¨í…Œì´ë„ˆ ì—”ì§„.
> docker CLIì™€ í†µí•©ë˜ì–´ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ë¹Œë“œ, ë°°í¬, ì‹¤í–‰ ì§€ì›.
> kubernetesì™€ í•¨ê»˜ ì‚¬ìš© ê°€ëŠ¥í•˜ì§€ë§Œ, 1.20 ë²„ì „ ì´í›„ Kubernetesì—ì„œëŠ” ê¸°ë³¸ ëŸ°íƒ€ì„ì—ì„œ ì œì™¸.
> **_(Podmanê³¼ CRI-Oë¥¼ ë³‘í–‰í•˜ì—¬ ì‚¬ìš© í•˜ëŠ” ê²ƒì´ í˜„ì¬ ë³´í†µ)_**
>
> **CRI-O:**
> Kubernetes ì „ìš©ìœ¼ë¡œ ì„¤ê³„ëœ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„.
> Open Container Initiative(OCI) í‘œì¤€ì„ ë”°ë¦„.
> containerdì™€ ìœ ì‚¬í•œ ì„±ëŠ¥ì„ ì œê³µí•˜ë©°, Kubernetesì™€ ê¸´ë°€í•˜ê²Œ í†µí•©ë¨.
>
> **Podman:**
> ë¬´ë°ëª¬(Daemonless) ì•„í‚¤í…ì²˜ë¥¼ íŠ¹ì§•ìœ¼ë¡œ í•¨.
> Dockerì™€ CLI í˜¸í™˜ì„±ì„ ì œê³µí•˜ë©°, ë£¨íŠ¸ë¦¬ìŠ¤(rootless) ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ê°€ëŠ¥.
> ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ Pod ê°œë…ì—ì„œ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì»¨í…Œì´ë„ˆ ì—”ì§„

> **ğŸ’» ìˆ˜í–‰** : ê° ë¦¬ëˆ…ìŠ¤ ìš´ì˜ ì²´ì œì— ë§ëŠ” ëª…ë ¹ì–´ë¥¼ í†µí•´ **_docker_** í˜¹ì€ **_podman_** ì„ ì„¤ì¹˜

```bash
# ì•„ë˜ëŠ” Rocky Linuxì—ì„œ docker ì„¤ì¹˜ ê¸°ì¤€

# íŒ¨í‚¤ì§€ ê´€ë¦¬ ë„êµ¬ ì—…ë°ì´íŠ¸
sudo dnf update -y --allowerasing

# íŒ¨í‚¤ì§€ ê´€ë¦¬ ìœ í‹¸ ì„¤ì¹˜
sudo dnf install -y yum-utils

# íŒ¨í‚¤ì§€ ê´€ë¦¬ ìœ í‹¸ì— ë„ì»¤ ì €ì¥ì†Œ ì„¤ì • ì§„í–‰
sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo

# ë„ì»¤ ê´€ë ¨ íŒ¨í‚¤ì§€ ì„¤ì¹˜
sudo dnf install -y docker-ce docker-ce-cli containerd.io --allowerasing
```

#### 2) ë„ì»¤ ì‹¤í–‰ ìƒíƒœ ì²´í¬

```bash
# ë„ì»¤ ì‹¤í–‰ ìƒíƒœ ì²´í¬
sudo systemctl status docker
```

```vim
[hso10@oracle ~]$ sudo systemctl status docker
â— docker.service - Docker Application Container Engine
   Loaded: loaded (/usr/lib/systemd/system/docker.service; disabled; vendor preset: disab>
   Active: inactive (dead)
     Docs: https://docs.docker.com

 6ì›” 26 17:52:38 oracle dockerd[2387592]: time="2025-06-26T17:52:38.246736550+09:00" leve>
 6ì›” 26 17:52:39 oracle dockerd[2387592]: time="2025-06-26T17:52:39.508974532+09:00" leve>
 6ì›” 30 12:53:50 oracle dockerd[2387592]: time="2025-06-30T12:53:50.469760843+09:00" leve>
 6ì›” 30 12:55:30 oracle dockerd[2387592]: time="2025-06-30T12:55:30.694143697+09:00" leve>
 6ì›” 30 12:56:06 oracle systemd[1]: Stopping Docker Application Container Engine...
 6ì›” 30 12:56:06 oracle dockerd[2387592]: time="2025-06-30T12:56:06.290388589+09:00" leve>
 6ì›” 30 12:56:06 oracle dockerd[2387592]: time="2025-06-30T12:56:06.291885577+09:00" leve>
 6ì›” 30 12:56:06 oracle dockerd[2387592]: time="2025-06-30T12:56:06.292504762+09:00" leve>
 6ì›” 30 12:56:06 oracle systemd[1]: docker.service: Succeeded.
 6ì›” 30 12:56:06 oracle systemd[1]: Stopped Docker Application Container Engine.
```

> **_docker.service: Succeeded_** ë¡œ ìƒíƒœ ì²´í¬

#### 3) ë„ì»¤ ë¯¸ì‹¤í–‰ ì‹œ ì‹¤í–‰ ëª…ë ¹ì–´

```bash
  sudo systemctl start docker
```

### 02. minikube

> **_ì˜¨í”„ë ˆë¯¸ìŠ¤ í™˜ê²½ì—ì„œ ì¿ ë²„ë„¤í‹°ìŠ¤ ì„œë¹„ìŠ¤ë¥¼ ìœ„í•œ ê²½ëŸ‰í™”ëœ ì¿ ë²„ë„¤í‹°ìŠ¤_**
> => kubeadm ë“±ë„ ì‚¬ìš© ê°€ëŠ¥í•˜ë‚˜ ì„¤ì¹˜ê°€ ì‰¬ìš´ minikube ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±

#### 1) minikube ì„¤ì¹˜

> [minikube ê³µì‹ë¬¸ì„œ](https://minikube.sigs.k8s.io/)

```bash
# ê³µì‹ ë¬¸ì„œ Linux 64 ì•„í‚¤í…ì³ ì„¤ì¹˜ ë°©ë²•
curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-latest.x86_64.rpm
sudo rpm -Uvh minikube-latest.x86_64.rpm
```

#### 2) minikube ì‹¤í–‰

```bash
##### - Docker ê¸°ì¤€ ì‹¤í–‰
minikube start --driver=docker

##### - Podman ê¸°ì¤€ ì‹¤í–‰
minikube start --driver=podman --container-runtime=cri-o
```

> **â— ë¬¸ì œ ë°œìƒ ì‹œ minikube ì œê±° í›„ ì¬ì‹œì‘ ë°©ë²•**

```bash
# í•´ë‹¹ ëª…ë ¹ì–´ ìˆ˜í–‰ ì‹œ ë™ì‘ë˜ëŠ” ì„œë¹„ìŠ¤, deployment, pod ë“±ì´ ì¢…ë£Œë¨ìœ¼ë¡œ ìœ ì˜í•˜ì—¬ ì‘ì—… í•„ìš”
# podëŠ” ì»¨í…Œì´ë„ˆë¡œ íœ˜ë°œì„±ì´ ìˆìŒìœ¼ë¡œ ì„¤ì •ì´ë‚˜ pod ë‚´ ìƒì„± íŒŒì¼ ë“±ì˜ ìœ ì‹¤ì— ì£¼ì˜í•  ê²ƒ
# => ë³„ë„ì˜ ë³¼ë¥¨(PV) ë“±ì„ ì„¤ì •í•˜ì—¬ ìœ ì‹¤ë˜ì§€ ì•Šê²Œ í•´ì•¼í•¨
minikube delete
minikube start --driver=docker
```

#### 3) minikube kubectl ëª…ë ¹ì–´ ë³„ì¹­ ë“±ë¡

> **minikube kubectl(ì¿ ë²„ë„¤í‹°ìŠ¤ ì¡°ì‘ì–´)ë¥¼ ì•½ì–´ë¡œ ëª…ë ¹ì–´ ì‚¬ìš©ì„ ìœ„í•´ ì•„ë˜ì™€ ê°™ì€ ì„¤ì • ì§„í–‰**

> **kubectl : Kubernetes í´ëŸ¬ìŠ¤í„°ë¥¼ ê´€ë¦¬í•˜ê³  ìƒí˜¸ì‘ìš©í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ëª…ë ¹ì¤„ ë„êµ¬**

```bash
# .bashrc ì™€ ê°™ì€ ë¦¬ëˆ…ìŠ¤ ì‚¬ìš©ì ì„¤ì • íŒŒì¼ì— ì…‹íŒ…í•œë‹¤
alias kubectl="minikube kubectl --"
```

### 03. ì„œë¹„ìŠ¤ ë°©ì‹ ì„¤ì •

#### 1) í•´ë‹¹ ì„œë²„ê°€ ì™¸ë¶€ IPë¥¼ ê°€ì§„ ì„œë²„ì˜ ê²½ìš°

> **ì•„ë˜ëŠ” ì˜ˆìƒë„ë¡œ ì‹¤ì œ êµ¬ì„±í•´ë³´ì§€ ì•ŠìŒ**

![alt text](/assets/images/ì™¸ë¶€IP_minikube.png)

#### 2) í•´ë‹¹ ì„œë²„ê°€ ë‚´ë¶€ IPë¥¼ ê°€ì§„ ì„œë²„ì˜ ê²½ìš°

> **í˜„ ì‘ì„±ê¸€ì€ ì•„ë˜ êµ¬ì„±ì„ í† ëŒ€ë¡œ ì‘ì„±
> => ë‚´ë¶€IP ëŒ€ì—­ : 192.168.0.0/16, 172.16.0.0/12, 10.0.0.0/8**

![alt text](/assets/images/ë‚´ë¶€IP_minikube.png)

```bash
# ë¯¸ë‹ˆì¿ ë²„ì˜ IP í™•ì¸ ëª…ë ¹ì–´
minikube ip

# ë¯¸ë‹ˆì¿ ë²„ì˜ addon(í™•ì¥)  list í™•ì¸
# ì„¤ì¹˜ ì „
minikube addons list
#|ingress |minikube |disabled |Kubernetes |

# ì„¤ì¹˜ ëª…ë ¹ì–´ ìˆ˜í–‰
minikube addons enable ingress

# ëŒ€ì‹œë³´ë“œ ì„¤ì¹˜(ì˜µì…˜)
minikube addons enable dashboard

# ì„¤ì¹˜ í›„
minikube addons list
#|ingress |minikube |enabled âœ… |Kubernetes |

# pod í™•ì¸ (-n : ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì¡°íšŒ)
kubectl get pods -n ingress-nginx
# NAME                                       READY   STATUS      RESTARTS   AGE
# ingress-nginx-admission-create-zhxrl       0/1     Completed   0          2m36s
# ingress-nginx-admission-patch-rsdbw        0/1     Completed   0          2m36s
# ingress-nginx-controller-67c5cb88f-rn85w   1/1     Running     0          2m36s

# ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
kubectl get svc -n ingress-nginx
#NAME                                 TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)                      AGE
#ingress-nginx-controller             NodePort    10.108.145.255   <none>        80:32301/TCP,443:30247/TCP   4m5s
#ingress-nginx-controller-admission   ClusterIP   10.98.128.72     <none>        443/TCP                      4m5s

# ingress ì„œë¹„ìŠ¤ YAML í™•ì¸ìš© ëª…ë ¹ì–´
kubectl get pod -n ingress-nginx -l app.kubernetes.io/component=controller -o yaml
# addon ìœ¼ë¡œ ì„¤ì¹˜ ì‹œ ì•„ë˜ì™€ ê°™ì´ í¬íŠ¸ ì‚¬ìš©ë¨ì„ í™•ì¸
- containerPort: 80
        hostPort: 80

# ingress í˜¸ì¶œ í…ŒìŠ¤íŠ¸
curl $(minikube ip):80
```

#### â—ì¶”ê°€ ë‚´ìš©(ì†ŒìŠ¤ ë¡œì§ì— ë”°ë¼ ì„ íƒì‚¬í•­)

> **í´ë¼ì´ì–¸íŠ¸ IP ë¥¼ ì±„ë²ˆí•˜ëŠ” ë¡œì§ì„ ìœ„í•´ì„œëŠ” XFF í—¤ë” ì„¤ì •ì´ í•„ìš”**
>
> **ğŸ’»XFF(X-Forwarded-For)ë€?** > **ë¡œë“œë²¨ëŸ°ì„œ í˜¹ì€ í”„ë¡ì‹œ ì„œë²„ë¥¼ ê²½ìœ í•  ê²½ìš° ì†ŒìŠ¤ ì½”ë“œ ìƒì—ì„œ í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ì—ì„œ IPë¥¼ ì±„ë²ˆí•  ë•Œ ë¡œë“œë²¨ëŸ°ì„œë‚˜ í”„ë¡ì‹œ ì„œë²„ì˜ ì£¼ì†Œë¡œ ì±„ë²ˆí•˜ê¸° ë•Œë¬¸ì— í´ë¼ì´ì–¸íŠ¸ IP ì±„ë²ˆì„ ìœ„í•œ í‘œì¤€ í—¤ë”**

```bash
# minikube ingress ì„¤ì • í™•ì¸
kubectl -n ingress-nginx get configmap ingress-nginx-controller -o yaml
apiVersion: v1
data:
  hsts: "false"
  #use-forwarded-headers: "true" => í•´ë‹¹ ì„¤ì •ì´ ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸ í›„ ì—†ëŠ” ê²½ìš° ì¶”ê°€

# ìˆ˜ì • ëª…ë ¹ì–´(vi í¸ì§‘ê¸° ìˆ˜ì •)
kubectl -n ingress-nginx edit configmap ingress-nginx-controller

# minikube ingress ì„¤ì • í™•ì¸
kubectl -n ingress-nginx get configmap ingress-nginx-controller -o yaml
apiVersion: v1
data:
  hsts: "false"
  use-forwarded-headers: "true"

# ì¸ê·¸ë ˆìŠ¤ deploy ì¬ê¸°ë™
kubectl -n ingress-nginx rollout restart deployment ingress-nginx-controller

# ìœ„ ì‚¬í•­ ì§„í–‰ í›„ ì•±ì—ì„œ XFF(X-Forwarded-For) í•´ë”ë¥¼ ì‚¬ìš©í•˜ê²Œ í•„í„° í˜¹ì€ ì±„ë²ˆ ë¡œì§ì„ ìˆ˜ì •
```

### 04 ì˜êµ¬ì ì¸ ë³¼ë¥¨ ìƒì„±

> **pod ë¼ë¦¬ ê°™ì€ ë³¼ë¥¨ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° nfs ìŠ¤í† ë¦¬ì§€ê°€ ìˆì–´ì•¼ í•œë‹¤**
> => **nfs ìŠ¤í† ë¦¬ì§€ê°€ ë³„ë„ë¡œ ì—†ëŠ” ê²½ìš° ì•„ë˜ì™€ ê°™ì´ nfs ìœ í‹¸ë¡œ ì„œë²„ë¥¼ ìƒì„±í•œë‹¤**

#### 1) NFS ì„œë²„ ì„¤ì¹˜ (Rocky Linux)

##### (1) NFS ìœ í‹¸ ì„¤ì¹˜

```bash
sudo dnf install -y nfs-utils
```

##### (2) NFS ì„œë¹„ìŠ¤ í™œì„±í™” ë° ì‹œì‘

```bash
sudo systemctl enable --now nfs-server
sudo systemctl start nfs-server
```

##### (3) NFS ê³µìœ  ë””ë ‰í† ë¦¬ ìƒì„± ë° export ì„¤ì •

```bash
sudo mkdir -p /nfs
sudo chown -R nobody:nobody /nfs
sudo chmod 777 /nfs
```

- /etc/exports ì— nfs ë””ë ‰í† ë¦¬ ì„¤ì •

```bash
echo "/nfs *(rw,sync,no_subtree_check,no_root_squash)" | sudo tee -a /etc/exports
```

- exportfs ì ìš©

```bash
sudo exportfs -rav
```

##### (4) NFS ì„œë²„ í™•ì¸

```bash
sudo exportfs -v
```

- ì¶œë ¥ì— /nfs ê°€ ì˜ ë‚˜ì˜¤ë©´ OK ì´ì œ í”„ë¡œê·¸ë¨ì— ì•Œë§ì€ PVCì™€ PVë¥¼ ì…‹íŒ…í•˜ê³  ì ìš©í•˜ë©´ëœë‹¤

##### (5) PVC/PV ì˜ˆì œ

```yaml
# NFS PVC/PV ì˜ˆì œ
apiVersion: v1
kind: PersistentVolume
metadata:
  name: nfs-pv
spec:
  capacity:
    storage: 50Gi
  accessModes:
    # NFSëŠ” ì—¬ëŸ¬ ë…¸ë“œ ë™ì‹œ ReadWrite ê°€ëŠ¥
    # (ReadWriteOnce|ReadWriteMany)
    - ReadWriteMany
  persistentVolumeReclaimPolicy: Retain
  nfs:
    # NFS ì„œë²„ì˜ IP ì£¼ì†Œ ë˜ëŠ” í˜¸ìŠ¤íŠ¸ ì´ë¦„
    server: 192.168.0.69
    # NFS ì„œë²„ì—ì„œ ê³µìœ í•˜ëŠ” ë””ë ‰í† ë¦¬ ê²½ë¡œ
    path: /data/pv/
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: nfs-pvc
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 50Gi
  # ìˆ˜ë™ í• ë‹¹ ì‹œ SC "" ìœ¼ë¡œ ì„¤ì •
  storageClassName: ""
---
```

### XX. TOMCAT ê°„ì˜ ì„¸ì…˜ í´ëŸ¬ìŠ¤í„°ë§

> **PODê°€ ì—¬ëŸ¬ ê°œ ìƒì„±ë  ê²½ìš° WAS ê°„ ì„¸ì…˜ ë¬¸ì œê°€ ë°œìƒë  ìˆ˜ ìˆë‹¤.** > **ë”°ë¼ì„œ TOMCAT í´ëŸ¬ìŠ¤í„°ë§ ì‘ì—…ì„ í•´ì•¼í•œë‹¤.** > **ì´ë¥¼ ìœ„í•´ REDIS DBë¥¼ ìƒì„±í•˜ê³  TOMCATì˜ ì„¸ì…˜ ì •ë³´ë¥¼ ì €ì¥í•˜ë„ë¡ êµ¬ì„±ì´ í•„ìš”í•˜ë‹¤.**

```bash
# í—¬ë¦„ì°¨íŠ¸ë¥¼ í†µí•´ ì¿ ë²„ë„¤í‹°ìŠ¤ì— ì„¸ì…˜ ê³µìœ ìš© redis ë°°í¬
  helm repo add bitnami https://charts.bitnami.com/bitnami
  helm install redis bitnami/redis --set architecture=standalone
# redis ë¹„ë°€ë²ˆí˜¸ í™•ì¸
  kubectl get secret --namespace default redis -o jsonpath="{.data.redis-password}" | base64 -d
```

> **helmìœ¼ë¡œ ì„¤ì¹˜ëœ redis ë¹„ë°€ë²ˆí˜¸ë¥¼ deployment í™˜ê²½ë³€ìˆ˜ì— ì…‹íŒ…**

```yaml
env:
  - name: REDIS_PASSWORD
    valueFrom:
      secretKeyRef:
        name: redis # Secret ì´ë¦„
        key: redis-password # Secret key ì´ë¦„ (ëŒ€ì†Œë¬¸ì ì •í™•íˆ ë§ì¶°ì•¼ í•¨)
```

> **í†°ì¼“ì˜ context.xml ì— ì•„ë˜ì™€ ê°™ì´ ì„¤ì •**

```xml
<Context>
  <Valve className="tomcat.request.session.redis.SessionHandlerValve" />
  <Manager className="tomcat.request.session.redis.SessionManager" />
</Context>
```

### XX. ì¿ ë²„ë„¤í‹°ìŠ¤ìš© DB ìƒì„±

```bash
# ì•„ë˜ ì‘ì„±ê¸€ì„ ì°¸ì¡°í•˜ì—¬ ì‘ì—… ì§„í–‰
# Blog
https://thekoguryo.github.io/oracle-cloudnative/databases/oracle-database/2.oracle-database-operator/
# github
https://github.com/oracle/oracle-database-operator

#cert-manager ì„¤ì¹˜
kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.13.1/cert-manager.yaml
#cert-manager ê¸°ë™ í™•ì¸
kubectl get pods -n cert-manager
#ìœ„ ëª…ë ¹ì–´ë¡œ ê¸°ë™ í™•ì¸ í›„ì— ì•„ë˜ ì§„í–‰í•´ì•¼ ì •í™•íˆ ì¸ì¦ì´ ë˜ì–´ ì„¤ì¹˜ê°€ ê°€ëŠ¥í•˜ë‹¤.
#NAME                                      READY   STATUS    RESTARTS   AGE
#cert-manager-767f578ff-twhhh              1/1     Running   0          79s
#cert-manager-cainjector-c7fdb4dbf-dx26l   1/1     Running   0          79s
#cert-manager-webhook-768bf9d966-s9mg8     1/1     Running   0          79s

#OraOperator ì„¤ì¹˜
kubectl apply -f https://raw.githubusercontent.com/oracle/oracle-database-operator/main/oracle-database-operator.yaml
#OraOperator ê¸°ë™ í™•ì¸
kubectl get pods -n oracle-database-operator-system

#oracle-database-operatorë¥¼ ì„¤ì¹˜
#ë‘ê°€ì§€ ì„ íƒì§€ê°€ ìˆìŒ(í´ëŸ¬ìŠ¤í„°ë‹¨ìœ„|ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë‹¨ìœ„)
#ì•„ë˜ëŠ” í´ëŸ¬ìŠ¤í„° ë‹¨ìœ„ì„¤ì •ìœ¼ë¡œ ì§„í–‰
# 1)ClusterRoleBinding ì„¤ì •
# https://github.com/oracle/oracle-database-operator/blob/main/rbac/cluster-role-binding.yaml
# ìœ„ URL ì°¸ì¡° íŒŒì¼ ìƒì„± í›„ ì ìš©
kubectl apply -f cluster-role-binding.yaml
# 2)ClusterRole and ClusterRoleBinding for NodePort services ì„¤ì •(ë¡œë“œë²¨ëŸ°ì„œ ì„œë¹„ìŠ¤ëŠ” í•„ìš” ì—†ìŒ)
# https://github.com/oracle/oracle-database-operator/blob/main/rbac/node-rbac.yaml
# ìœ„ URL ì°¸ì¡° íŒŒì¼ ìƒì„± í›„ ì ìš©
kubectl apply -f node-rbac.yaml
# 3)oracle-database-operator ì„¤ì¹˜
# https://github.com/oracle/oracle-database-operator/blob/main/oracle-database-operator.yaml
# ìœ„ URL ì°¸ì¡° íŒŒì¼ ìƒì„± í›„ ì ìš©
kubectl get pod -n oracle-database-operator-system
# ìƒíƒœ ì²´í¬
kubectl get pod -n oracle-database-operator-system
#NAME                                                           READY   STATUS    RESTARTS   AGE
#oracle-database-operator-controller-manager-7898b79f6b-28x2f   1/1     Running   0          68s
#oracle-database-operator-controller-manager-7898b79f6b-fzsrc   1/1     Running   0          68s
#oracle-database-operator-controller-manager-7898b79f6b-wzwzv   1/1     Running   0          68s

# oracle ì‚¬ìš© secret ì…‹íŒ…(ì˜¤ë¼í´ íŒ¨ìŠ¤ì›Œë“œ ì„¤ì •)
## Oracle Database Free Admin password secret
apiVersion: v1
kind: Secret
metadata:
  name: freedb-admin-secret
  namespace: default
type: Opaque
stringData:
  ## í•´ë‹¹ë¶€ë¶„ DB password ì…‹íŒ…
  oracle_pwd: your_DB_password

# oracle_free SIDB(ì‹±ê¸€ì¸ìŠ¤í„´ìŠ¤DB) ë²„ì „ ì„¤ì¹˜
# https://github.com/oracle/oracle-database-operator/blob/main/config/samples/sidb/singleinstancedatabase_free.yaml
# ìœ„ URL ì°¸ì¡°(ì‹±ê¸€ì¸ìŠ¤í„´ìŠ¤DB free ë²„ì „) íŒŒì¼ ìƒì„± í›„ ì ìš©
# minikube ì„¤ì¹˜ ì‹œ ìŠ¤í† ë¦¬ì§€í´ë˜ìŠ¤ standard ë¡œ ì„¤ì •
# free ë²„ì „ì€ ë ˆí”Œë¦¬ì¹´ ìˆ˜ 1ê°œ ê³ ì •
kubectl apply -f singleinstancedatabase_free.yaml
# ìƒíƒœ ì²´í¬1
kubectl get events --sort-by='.metadata.creationTimestamp' -A
# Pulling image "container-registry.oracle.com/database/free:latest"
# ìƒíƒœ ì²´í¬2
kubectl get SingleInstanceDatabase
#NAME            EDITION   STATUS    ROLE          VERSION       CONNECT STR   TCPS CONNECT STR   OEM EXPRESS URL
#freedb-sample   Free      Pending   Unavailable   Unavailable   Unavailable   Unavailable        Unavailable
# Pending -> Healthy ë¡œ ë˜ë©´ ì„±ê³µ
# ì¤‘ê°„ì— unhealthy ë‚˜ updating ìƒíƒœ ì‹œ ëŒ€ê¸° í˜¹ì€ ì•„ë˜ ëª…ë ¹ì–´ë¡œ ìƒíƒœ ì²´í¬3
kubectl describe SingleInstanceDatabase/freedb-sample
# ì´ë¯¸ì§€ í¬ê¸°ê°€ ì»¤ì„œ ë‹¤ì†Œ ì‹œê°„ì´ ì†Œìš”ë©ë‹ˆë‹¤.
 kubectl get SingleInstanceDatabase
# NAME            EDITION   STATUS    ROLE      VERSION        CONNECT STR               TCPS CONNECT STR   OEM EXPRESS URL
# freedb-sample   Free      Healthy   PRIMARY   23.8.0.25.04   192.168.49.2:32532/FREE   Unavailable        Unavailable
# pod í™•ì¸
kubectl get pod -n default
#NAME                  READY   STATUS    RESTARTS   AGE
#freedb-sample-7ww2z   1/1     Running   0          11m

# DB ì ‘ì† í™•ì¸
sqlplus sys/your_DB_password@192.168.49.2:32532/FREE as sysdba

# ì™¸ë¶€ì—ì„œ ë‚´ë¶€ minikube ip ì˜ ì˜¤ë¼í´ì— ë¶™ëŠ” ë°©ë²• ì˜ˆì‹œ
sudo socat TCP-LISTEN:1521,fork TCP:192.168.49.2:32532
# í˜¹ì€ nginx stream í”„ë¡ì‹œ ì‚¬ìš©

```

### 05. ë°°í¬ëª¨ë“ˆ ì´ë¯¸ì§€í™”

### 06. deployment ìƒì„±

### 07. pod ìƒì„±

`kubectl expose deployment nginx-deployment --type=NodePort --port=80`

### 06. CI/CD êµ¬ì„±(GITHUB ì›¹í›… ë° ì  í‚¨ìŠ¤ ì‚¬ìš©)
